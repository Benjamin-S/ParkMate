@model CreateBookingViewModel;

@{
    ViewData["Title"] = "Create a Booking";
}

<h1>Create a Booking</h1>

<div>
    @if (!Model.ParkingSpace.Query.Success)
    {
        <div class="alert alert-danger" role="alert">
            @Model.ParkingSpace.Query.Message
        </div>
    }
</div>

<div>
    @if (!Model.Customer.Query.Success)
    {
        <div class="alert alert-danger" role="alert">
            @Model.Customer.Query.Message
        </div>
    }
</div>

@{
    if (Model.ParkingSpace.Query.Success)
    {
        var parkingSpace = Model.ParkingSpace.Query.Payload;
        <div class="card flex-row flex-wrap">
            <div class="card-header">
                <img id="parking-image" class="card-img" src="/imageuploads/@Model.ParkingSpace.Query.Payload.ImageURL" alt="Card image cap">
            </div>
            <div class="card-body">
                <h5 class="card-title">@Model.ParkingSpace.Query.Payload.Title</h5>
                <p class="card-text">Description: @Model.ParkingSpace.Query.Payload.Description</p>
                <p class="card-text">Hourly Rate: @Model.ParkingSpace.Query.Payload.HourlyRate</p>
                <p class="card-text">Daily Rate: @Model.ParkingSpace.Query.Payload.DailyRate</p>
            </div>
            <div class="w-100"></div>
        </div>
    }
}

<form method="post" enctype="multipart/form-data" id="form">
    <div class="form-group" hidden="true">
        <input asp-for="CustomerId" value="@Model.Customer.Query.Payload.CustomerId" readonly/>
        <input asp-for="ParkingSpaceId" value="@Model.ParkingSpace.Query.Payload.ParkingSpaceId" readonly/>
        <input asp-for="HourlyRate" value="@Model.ParkingSpace.Query.Payload.HourlyRate" readonly/>
        <input asp-for="DailyRate" value="@Model.ParkingSpace.Query.Payload.DailyRate" readonly/>
        
    </div>
    <div class="form-group">
        <label asp-for="BookingType">Booking Type</label>
        <select asp-for="BookingType" id="BookingType">
            <option value="1">Hourly</option>
            <option value="2">Daily</option>
        </select>
    </div>
    <div class="form-group">
        <label for="Start">Start Date</label>
        <input asp-for="Booking.Start" type="datetime-local" id="Start" class="form-control flatpickr"/>
    </div>
    <div class="form-group">
        <label for="End">End Date</label>
        <input asp-for="Booking.End" type="datetime-local" id="End" class="form-control flatpickr"/>
    </div>
    <div class="form-group">
        <label for="vehicle-select">Vehicle</label>
        <select asp-for="VehicleId" class="form-control" id="vehicle-select">
            @{
                if (Model.Customer.Query.Success)
                {
                    if (Model.Customer.Query.Payload.Vehicles.Count == 0)
                    {
                        <option disabled="disabled">No vehicles found</option>
                    }
                    else
                    {
                        foreach (var vehicle in Model.Customer.Query.Payload.Vehicles)
                        {
                            <option value="@vehicle.VehicleId">@vehicle.Colour @vehicle.Make @vehicle.Model - @vehicle.Registration</option>
                        }
                    }
                }
            }
        </select>
    </div>
    <button class="btn btn-primary" type="submit">Submit</button>
</form>

@section Scripts
{
    <partial name="_DateTimePicker"/>
    <script>
        document.getElementById("parking-image").style.maxWidth = "200px";
    </script>
}
